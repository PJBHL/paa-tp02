package Components;
import java.util.*;

public class Consumo {
    public static int k = 2; // Capacidade de produtos do caminhao.
    public static double rendimento = 10; // Rendimento em km/l do caminhao.
    public static double distancia; // distancia entre uma loja e outra.
    public static final double CONSUMO_POR_PRODUTO = 0.5;

    public static double calcularConsumoAtual(ArrayList<Loja> listaLoja, ArrayList<Integer> permutacao) {
        // Partida da matriz.
        int origemX = listaLoja.get(0).x;
        int origemY = listaLoja.get(0).y;
        int cargaAtual = 0;
        double consumoDoCaminho = 0.0;

        for(int indexLoja : permutacao) {
            Loja lojaAtual = listaLoja.get(indexLoja);

            int destinoX = lojaAtual.x;
            int destinoY = lojaAtual.y;
            System.out.println("Loja: " + lojaAtual.id + "(" + origemX + ", " + origemY + ") " + "Para: " + "(" + destinoX + ", " + destinoY + ") ");

            // Distancia entre dois pontos = (x1 - x2)^2 + (y1 - y2)^2
            double distancia = Math.sqrt(Math.pow(destinoX - origemX, 2) + Math.pow(destinoY - origemY, 2));

            int produtosEntregues = Math.min(k, cargaAtual);
            cargaAtual -= produtosEntregues;

            System.out.println("Produtos Entregues nessa viagem: " + produtosEntregues + " Carga Atual: " + cargaAtual);

            int produtosColetados = Math.min(k - cargaAtual, lojaAtual.destinos.size());
            cargaAtual += produtosColetados;

            System.out.println("Produtos Coletados nessa viagem: " + produtosColetados + " Carga Atual: " + cargaAtual);

            double consumoViagemAtual = distancia / rendimento;
            double consumoCarga = produtosColetados * CONSUMO_POR_PRODUTO;

            System.out.println("Consumo atual (km/l e custo de produto 0,5): " + consumoCarga);

            consumoDoCaminho += consumoViagemAtual + consumoCarga;
            System.out.println("Distancia apenas de uma loja para outra: " + distancia + " Consumo dessa distancia (km/l): " + consumoViagemAtual);

            System.out.println("Consumo desse trajeto atual: " + consumoDoCaminho);

            // Próxima Loja.
            origemX = destinoX;
            origemY = destinoY;
            rendimento -= consumoCarga;
        }

        System.out.println("Custo total dessa permutação: " + consumoDoCaminho);

        return consumoDoCaminho;
    }
}
